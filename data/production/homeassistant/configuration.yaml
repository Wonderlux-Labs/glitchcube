# Glitch Cube Home Assistant Configuration
# Main configuration file for the art installation

# Basic configuration
homeassistant:
  name: "Glitch Cube"
  latitude: 40.7682435937 
  longitude: -119.218725792
  elevation: 3848
  time_zone: "America/Los_Angeles"

  
  # Allow external webhooks for art installation
  external_url: "https://zjd6lgd6yhigawnj06mkguhholcsfdul.ui.nabu.casa:8123"
  internal_url: "http://glitchcube.local:8123"

# Enable frontend and API
frontend:
  themes: !include_dir_merge_named themes

# Enable configuration panel
config:

# Enable logbook for tracking interactions
logbook:
  include:
    domains:
      - glitchcube
      - sensor
      - automation
  exclude:
    entities:
      - sensor.system_temperature  # Too frequent for logbook

# Enable history tracking
history:
  include:
    domains:
      - sensor
      - input_datetime
      - input_text
  exclude:
    entities:
      - sensor.system_temperature  # High frequency sensor

# Enable recorder with optimized settings for art installation
recorder:
  db_url: sqlite:////config/home-assistant_v2.db
  purge_keep_days: 10  # Keep 30 days of history
  commit_interval: 5   # Commit every 5 seconds for reliability
  include:
    domains:
      - sensor
      - automation
      - input_datetime
      - input_text
      - logbook
    entities:
      - sensor.glitch_cube_app_health
      - sensor.internet_connectivity
      - sensor.installation_health
      - sensor.last_interaction_time
      - sensor.current_persona

# HTTP configuration for webhooks
http:
  use_x_forwarded_for: true
  trusted_proxies:
    - 127.0.0.1
    - 192.168.0.0/16
    - 172.16.0.0/12
    - 10.0.0.0/8

# Network discovery (removed - deprecated in modern HA)
# discovery:

# Enable mobile app support
mobile_app:

# Enable system health
system_health:

# Enable diagnostics
diagnostics:

# Include separate configuration files
automation: !include automations.yaml
script: !include scripts.yaml

# Include all input helpers (each type from separate files)
input_datetime: !include input_helpers/input_datetime.yaml
input_text: !include input_helpers/input_text.yaml
input_number: !include input_helpers/input_number.yaml
input_boolean: !include input_helpers/input_boolean.yaml

# Include all sensors (REST sensors and template sensors)
sensor: !include sensors.yaml

# Enable webhook integration (for external API calls)
webhook:

# Enable RESTful API
api:

# Scene configuration for different installation modes
scene: !include scenes.yaml

# Panel iframe configuration for Docker container integration
# Adds File Editor and Log Viewer to the sidebar like official add-ons
panel_iframe:
  # File Editor (equivalent to HA File Editor add-on)
  file_editor:
    title: 'File Editor'
    url: 'http://glitchcube.local:3218'
    icon: mdi:file-document-edit-outline
    
  # Log Viewer (Dozzle - shows all container logs)
  log_viewer:
    title: 'Log Viewer'
    url: 'http://glitchcube.local:8888'
    icon: mdi:file-document-multiple-outline